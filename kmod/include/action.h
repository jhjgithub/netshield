#ifndef _ACTION__H__
#define _ACTION__H__

///////////////////////////////////////////
// define Action on 64 bits

#define ACT_DISABLE 		0x0000000000000001LLU
#define ACT_BIDIR			0x0000000000000002LLU
#define ACT_ALLOW			0x0000000000000004LLU
#define ACT_DROP			0x0000000000000008LLU
#define IS_BIDIR(p) 		((p)->action & ACT_BIDIR)

// for IPS Engine
#define ACT_IPS_SMD			0x0000000000000010LLU
#define ACT_IPS_URL_FILTER	0x0000000000000020LLU
#define ACT_IPS_WEBMAIL		0x0000000000000040LLU
#define ACT_IPS_MASK		0x0000000000000080LLU 

// for NAT Engine
#define ACT_SNAT			0x0000000000000100LLU
#define ACT_DNAT			0x0000000000000200LLU
#define ACT_BNAT 			0x0000000000000400LLU // Both NAT(SNAT + DNAT)
#define ACT_PNAT 			0x0000000000000800LLU // Pass Through NAT
#define ACT_SINGLE_NAT 		(ACT_SNAT | ACT_DNAT)
#define ACT_NAT 			(ACT_SINGLE_NAT | ACT_BNAT)
#define ACT_ALL_NAT 		(ACT_NAT  | ACT_PNAT)
#define ACT_NAT_ADJ_SEQ		0x0000000000001000LLU // FTP 세션과 같이 proxy에 의해서 패킷이 변경된 경우 SEQ 조정 ACTION
#define ACT_NAT_RELEASE 	0x0000000000002000LLU // 세션이 삭제 될때 NAT ip/port 정보를 릴리즈 한다.

// for LOG Engine
#define ACT_LOG_CLOSE 		0x0000000000010000LLU // default LOG option
#define ACT_LOG_CREATE		0x0000000000020000LLU 
#define ACT_LOG_INFO		0x0000000000040000LLU

// for internal
#define ACT_SAVED_LOG_PPS 	0x0000000000080000LLU
#define ACT_SAVED_LOG_BPS 	0x0000000000100000LLU
#define ACT_SAVED_LOG_CPS 	0x0000000000200000LLU

// for Time Object
#define ACT_TIME_EXCEED 	0x0000000001000000LLU // set or unset by Time Object

// for Special Engine
#define ACT_TCP_ASSEMBLE 	0x0000000010000000LLU
#define ACT_PSD 			0x0000000020000000LLU
#define ACT_BLACKLIST 		0x0000000040000000LLU
#define ACT_PRXY_FTP 		0x0000000080000000LLU
#define ACT_RATE_LIMIT 		0x0000000100000000LLU

// for Localhost Packet
// localhost 룰은 IP영역이 ANY로 설정 된다.
// 그러므로 아래의 속성이 있는 경우 
// 패킷의 IP를 NIC의 IP와 추가로 비교 한다.
#define ACT_LOCALHOST_SRC	0x0000000200000000LLU
#define ACT_LOCALHOST_DST	0x0000000400000000LLU
#define ACT_SYNP 			0x0000000800000000LLU

// for IPSEC
#define ACT_AH				0x0000001000000000LLU
#define ACT_ESP				0x0000002000000000LLU
#define ACT_IPSEC			(ACT_AH | ACT_ESP)

#endif
